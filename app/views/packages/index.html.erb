<% provide(:title, 'View Packages') %>
<h6>Packages->View</h1>
<div class="row-fluid">
  <div class="span12">
  <form action="/packages" class="form-search" method ="get">
    <div class="span1">
	  <%= collection_select(:account,  :account_id, Account.all, :id, :id, {:prompt => "Account"}, {:id => 'account_search', :selected=> params[:account_id]})%>
    </div>
    <div class="span1">
	   <%= collection_select(:project, :project_id,  @projects,  :id, :id, {:prompt   => "Project"}, { :id => 'project_search', :selected=> params[:project_id]})%>
    </div>
    <div class="span1">
      <%= text_field_tag :batch_search, params[:batch_search], :placeholder => "Batch" %>
    </div>
    <div class="span2">
      <%= select_tag :activity_search, options_for_select(["activities", "submitted", "rejected", "archived", "disseminated", "error", "withdrawn"]) %>
    </div>
    <div class="span2">
      <%= text_field_tag :start_time_search, params[:start_time_search], :type=> "date", :title => "Start Date" %>
    </div>
    <div class="span2">
      <%= text_field_tag :end_time_search, params[:end_time_search], :type=> "date", :title => "End Date" %>
    </div>
    <div class="span3">
	  <div class="input-append">
      <%= text_field_tag :id_search, params[:id_search], :size => 13, :class => 'search-query', :placeholder => "IEID or Package Name" %>
      <%= button_tag(type: "submit", class: "btn") do %>
         <i class="icon-search"></i>
         <% end %>
	  </div>
	</div>
  </form>
  </div>
</div>

<%= will_paginate @results%>
<table class="table table-condensed table-striped">
  <thead>
    <tr>
      <th><%= sortable "IEID" %></th>
      <th><%= sortable "Package Name" %></th>
      <th><%= sortable "Account" %></th>
      <th><%= sortable "Project" %></th>
      <th><%= sortable "Size" %></th>
      <th><%= sortable "# Files" %></th>
      <th><%= sortable "Latest Activity" %></th>
      <th><%= sortable "Timestamp" %></th>
      <th>Title</th>
      <th>Volume</th>
      <th>Issue</Th.
    </tr>
  </thead>
  <tbody>
    <% @results.each do |result| %>
    <tr>
      <td><%= result.id %></td>
      <td><%= result.name %></td>
      <td><%= result.account_id %></td>
      <td><%= result.project_id %></td>
      <td><%= result.size_in_bytes %></td>
      <td><%= result.number_of_datafiles %></td>
      <td><%= result.event_name%></td>
      <td><%= result.timestamp.strftime("%a %b %d %Y %I:%M:%S %p") %></td>
    </tr>
    <% end %>
  </tbody>
</table>
<%= will_paginate @results%> 
